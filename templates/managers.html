{% extends "base.html" -%}
{% block body %}
{% if user.Salary == None %}
    <script> document.location.href="/" </script>
{% endif %}

<h1 style="text-align:center; padding-bottom: 30px;"> Managers </h1>

<h1> {{message}} </h1>

<script>

    function addNew(){
        swal('<form action="/addstaff" method="POST" >'+
             '<h2> Add new Worker </h2>'+
             '<span>Name: <input type="text" name="name" /></p>'+
             '<span>SIN: <input type="text" name="sin" /></p>'+
             '<span>Address: <input type="text" name="address" /></p>'+
             '<span>BirthDate: <input type="text" name="birthdate" /></p>'+
             '<span>Phone: <input type="text" name="phone" /></p>'+
             '<span>Email: <input type="text" name="email" /></p>'+
             '<span>Bank Info: <input type="text" name="bank" /></p>'+
             '<input type="submit" value="Add new Worker" />'+
             '</form> ');
    }

    function modify(id){
        swal('<form action="/modstaff" method="POST">'+
             '<h2> Modify Staff</h2>'+
             '<span>SKU: <input type="text" name="staff_id" value="'+id+'" /></p>'+
             '<span>Name: <input type="text" name="name" /></p>'+
             '<span>Price: <input type="text" name="price" /></p>'+
             '<span>Amount: <input type="text" name="amount" /></p>'+
             '<span>Section: <input type="text" name="section" /></p>'+
             '<span>Weight (g/item): <input type="text" name="weight" /></p>'+
             '<input type="submit" value="Modify" />'+
             '</form> ');
    }
</script>

<p style="width: 100%; padding-bottom: 30px;">
	<a onclick="addNew()" style="margin-left:43%;border: 2px solid blue; color:purple; padding:10px;"> Add New Staff </a>
</p>

<table cellspacing="10px">
    <thead>
        <tr>
            <td>Manager ID </td>
            <td>Name</td>
            <td>Start Date</td>
            <td>Date Start Manager </td>
			<td>Salary ($/month)</td>
        </tr>
    </thead>
    <tbody>
        {% for staff in people %}
            <tr>
                <td>{{staff.Staff_ID}} </td>
                <td>{{staff.Name}} </td>
                <td>{{staff.Date_info_Start}} </td>
                <td>{{staff.Date_info_Start_Manager}} </td>
                <td>{{staff.Salary}} </td>
                <td><button style = "background-color: #4CAF50; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px;" onclick="modify({{staff.Staff_ID}})"> Modify </button></td>
                <td>
                    <form method="POST" action="/delstaff">
                        <input type="text" name="id" value={{staff.Staff_ID}} style="display:none"/>
                        <input type="submit" style="background-color: red; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px;" value="Delete"/> 
                    </form>
                </td>
                <td><buttononclick="analize({{staff.Staff_ID}});">Check Dependants</button></td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<script type="text/javascript">
    function analize(s_id){
        fetch("http://35.182.249.219:5000/api/staffs/"+s_id)
            .then((value) => value.json())
            .then((valueJSON)=> {
                let output = "Dependants: \n";

                for (let data of valueJSON){	
                    output+=  "StaffID: "+data["Staff_ID"]+"\n"+
                              "SIN: "+data["dSin"]+"\n"+
                              "dName: "+data["d_Name"] +"\n"+
                              "birthdate: " +data["Birthdate"]+"\n";
                }

                confirm(output);
            });
    }
</script>


{% endblock body %}
